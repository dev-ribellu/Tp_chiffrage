<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chiffré & Déchiffré</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Bienvenue sur Chiffré & Déchiffré</h1>

    <div class="section">
        <h2>Chiffrement</h2>
        <input type="text" id="message_a_crypter" placeholder="Entrez votre message à chiffrer">
        <input type="text" id="MDP" placeholder="Entrez la clef">
        <button id="btn_crypt" onclick="start()">Chiffrer le message</button>
        <div id="resultat_crypt_div"></div>
    </div>

    <div class="section">
        <h2>Déchiffrement</h2>
        <input type="text" id="message_a_decrypter" placeholder="Entrez votre message à déchiffrer">
        <input type="text" id="MDP_decrypt" placeholder="Entrez la clef">
        <button id="btn_decrypt" onclick="startDecrypt()">Déchiffrer le message</button>
        <div id="resultat_decrypt_div"></div>
    </div>

    <script>
        let resultat_decrypt_div = document.getElementById("resultat_decrypt_div");
        let resultat_crypt_div = document.getElementById("resultat_crypt_div");
        let mdp = document.getElementById("MDP");
        let message_N_C = document.getElementById("message_a_crypter");
        let message_a_decrypter = document.getElementById("message_a_decrypter");
        let mdp_decrypt = document.getElementById("MDP_decrypt");
        let somme_Ascii = 0;

        function avoir_Somme(m){
            somme_Ascii = 0;
            for (let index = 0; index < m.length; index++) {
                somme_Ascii += m.charCodeAt(index);
            }
            somme_Ascii = somme_Ascii % 26;
            console.log(somme_Ascii);
            return somme_Ascii;
        }

        function transform_to_ascii(message) {
            let tab = [];
            for (let index = 0; index < message.length; index++) {
                tab[index] = message.charCodeAt(index); 
            }
            return tab;
        }

        function transform_to_letter(tab) {
            let result = "";
            for (let index = 0; index < tab.length; index++) {
                result += String.fromCharCode(tab[index]); 
            }
            return result;
        }

        function encrypt(message, somme){
            for (let index = 0; index < message.length; index++) {
                if (message[index] >= 65 && message[index] <= 90) {
                    message[index] = ((message[index] - 65 + somme) % 26) + 65;
                } else if (message[index] >= 97 && message[index] <= 122) {
                    message[index] = ((message[index] - 97 + somme) % 26) + 97;
                }
            }
            return message;
        }
        
        function decrypt(message, somme){
            for (let index = 0; index < message.length; index++) {
                if (message[index] >= 65 && message[index] <= 90) {
                    message[index] = ((message[index] - 65 - somme + 26) % 26) + 65;
                } else if (message[index] >= 97 && message[index] <= 122) {
                    message[index] = ((message[index] - 97 - somme + 26) % 26) + 97;
                }
            }
            return message;
        }

        // Fonction pour chiffrer
        function start() {
            let password = mdp.value;
            
            if (message_N_C.value === "" || password === "") {
                resultat_crypt_div.textContent = "⚠ Veuillez remplir tous les champs";
                return;
            }
            
            avoir_Somme(password); 
            let tab_ascii = transform_to_ascii(message_N_C.value); 
            
            let encrypted = encrypt(tab_ascii, somme_Ascii);
            resultat_crypt_div.textContent = "Message chiffré : " + transform_to_letter(encrypted);
        }

        // Fonction pour déchiffrer
        function startDecrypt() {
            let password = mdp_decrypt.value;
            
            if (message_a_decrypter.value === "" || password === "") {
                resultat_decrypt_div.textContent = "⚠ Veuillez remplir tous les champs";
                return;
            }
            
            avoir_Somme(password);
            let tab_ascii = transform_to_ascii(message_a_decrypter.value);
            
            let decrypted = decrypt(tab_ascii, somme_Ascii);
            resultat_decrypt_div.textContent = "Message déchiffré : " + transform_to_letter(decrypted);
        }
    </script>
</body>
</html>